-- FIT9132 Bug Smashers Schema
-- 2017

DROP SEQUENCE charter_charter_nbr_seq;

DROP SEQUENCE charter_type_ctype_nbr_seq;

DROP SEQUENCE client_client_nbr_seq;

DROP SEQUENCE employee_emp_nbr_seq;

DROP SEQUENCE helicopter_type_ht_nbr_seq;

DROP SEQUENCE location_location_nbr_seq;


-- Generated by Oracle SQL Developer Data Modeler 4.2.0.932
--   site:      Oracle Database 11g
--   type:      Oracle Database 11g

DROP TABLE charter CASCADE CONSTRAINTS;

DROP TABLE charter_leg CASCADE CONSTRAINTS;

DROP TABLE charter_type CASCADE CONSTRAINTS;

DROP TABLE client CASCADE CONSTRAINTS;

DROP TABLE employee CASCADE CONSTRAINTS;

DROP TABLE endorsement CASCADE CONSTRAINTS;

DROP TABLE helicopter CASCADE CONSTRAINTS;

DROP TABLE helicopter_type CASCADE CONSTRAINTS;

DROP TABLE location CASCADE CONSTRAINTS;

CREATE TABLE charter (
    charter_nbr              NUMBER(4) NOT NULL,
    charter_cost_per_hour    NUMBER(6, 2) NOT NULL,
    charter_nbr_passengers   NUMBER(2) NOT NULL,
    charter_special_reqs     VARCHAR2(50),
    ctype_nbr                NUMBER(2) NOT NULL,
    heli_callsign            CHAR(6) NOT NULL,
    client_nbr               NUMBER(4) NOT NULL,
    emp_nbr                  NUMBER(4) NOT NULL
);

COMMENT ON COLUMN charter.charter_nbr IS
    'Identifier for a charter';

COMMENT ON COLUMN charter.charter_cost_per_hour IS
    'The charter cost per hour for this charter';

COMMENT ON COLUMN charter.charter_nbr_passengers IS
    'Number of passengers for this charter';

COMMENT ON COLUMN charter.charter_special_reqs IS
    'Special requirements for this charter (simplified as varchar - text attribute)';

COMMENT ON COLUMN charter.ctype_nbr IS
    'Identifier for type of charter';

COMMENT ON COLUMN charter.heli_callsign IS
    'Helicopters call sign - identifies a helicopter';

COMMENT ON COLUMN charter.client_nbr IS
    'Client number';

COMMENT ON COLUMN charter.emp_nbr IS
    'Employee number (identifier)';

ALTER TABLE charter ADD CONSTRAINT charter_pk PRIMARY KEY ( charter_nbr );

CREATE TABLE charter_leg (
    cl_leg_nbr                 NUMBER(2) NOT NULL,
    charter_nbr                NUMBER(4) NOT NULL,
    cl_etd                     DATE NOT NULL,
    cl_eta                     DATE NOT NULL,
    cl_atd                     DATE,
    cl_ata                     DATE,
    location_nbr_origin        NUMBER(3) NOT NULL,
    location_nbr_destination   NUMBER(3) NOT NULL
);

COMMENT ON COLUMN charter_leg.cl_leg_nbr IS
    'The leg number for this charter';

COMMENT ON COLUMN charter_leg.charter_nbr IS
    'Identifier for a charter';

COMMENT ON COLUMN charter_leg.cl_etd IS
    'Charter leg estimated time of departure';

COMMENT ON COLUMN charter_leg.cl_eta IS
    'Charter leg estimated time of arrival';

COMMENT ON COLUMN charter_leg.cl_atd IS
    'Charter leg actual time of departure';

COMMENT ON COLUMN charter_leg.cl_ata IS
    'Charter actual time of arrival';

COMMENT ON COLUMN charter_leg.location_nbr_origin IS
    'Identifier for a location';

COMMENT ON COLUMN charter_leg.location_nbr_destination IS
    'Identifier for a location';

ALTER TABLE charter_leg ADD CONSTRAINT charter_leg_pk PRIMARY KEY ( cl_leg_nbr, charter_nbr
 );

CREATE TABLE charter_type (
    ctype_nbr           NUMBER(2) NOT NULL,
    ctype_description   VARCHAR2(50) NOT NULL
);

COMMENT ON COLUMN charter_type.ctype_nbr IS
    'Identifier for type of charter';

COMMENT ON COLUMN charter_type.ctype_description IS
    'Text description of type of charter';

ALTER TABLE charter_type ADD CONSTRAINT charter_type_pk PRIMARY KEY ( ctype_nbr );

CREATE TABLE client (
    client_nbr        NUMBER(4) NOT NULL,
    client_lname      VARCHAR2(30) NOT NULL,
    client_fname      VARCHAR2(30),
    client_address    VARCHAR2(50) NOT NULL,
    client_suburb     VARCHAR2(50) NOT NULL,
    client_postcode   CHAR(4) NOT NULL,
    client_contact    CHAR(10) NOT NULL
);

COMMENT ON COLUMN client.client_nbr IS
    'Client number';

COMMENT ON COLUMN client.client_lname IS
    'Clients family name';

COMMENT ON COLUMN client.client_fname IS
    'Clients given name';

COMMENT ON COLUMN client.client_address IS
    'Client street address';

COMMENT ON COLUMN client.client_suburb IS
    'Suburb client is located in';

COMMENT ON COLUMN client.client_postcode IS
    'Clients postcode';

COMMENT ON COLUMN client.client_contact IS
    'Clients contact phone number';

ALTER TABLE client ADD CONSTRAINT client_pk PRIMARY KEY ( client_nbr );

CREATE TABLE employee (
    emp_nbr         NUMBER(4) NOT NULL,
    emp_lname       VARCHAR2(30) NOT NULL,
    emp_fname       VARCHAR2(30),
    emp_address     VARCHAR2(50) NOT NULL,
    emp_suburb      VARCHAR2(50) NOT NULL,
    emp_postcode    CHAR(4) NOT NULL,
    emp_contact     CHAR(10) NOT NULL,
    emp_taxfileno   VARCHAR2(20) NOT NULL,
    emp_salary      NUMBER(8, 2) NOT NULL,
    emp_nextofkin   VARCHAR2(30) NOT NULL,
    emp_is_pilot    CHAR(1) NOT NULL
);

ALTER TABLE employee ADD CONSTRAINT chk_emp_is_pilot CHECK (
    emp_is_pilot IN (
        'N', 'Y'
    )
);

COMMENT ON COLUMN employee.emp_nbr IS
    'Employee number (identifier)';

COMMENT ON COLUMN employee.emp_lname IS
    'Family name of employee';

COMMENT ON COLUMN employee.emp_fname IS
    'Employee given name';

COMMENT ON COLUMN employee.emp_address IS
    'Employee street address';

COMMENT ON COLUMN employee.emp_suburb IS
    'Employee residence suburb';

COMMENT ON COLUMN employee.emp_postcode IS
    'Employee residence postcode';

COMMENT ON COLUMN employee.emp_contact IS
    'Employees phone contact number';

COMMENT ON COLUMN employee.emp_taxfileno IS
    'Employee taxfile number';

COMMENT ON COLUMN employee.emp_salary IS
    'Employee Salary';

COMMENT ON COLUMN employee.emp_nextofkin IS
    'Name of employees next of kin';

COMMENT ON COLUMN employee.emp_is_pilot IS
    'Flag to indicate employee is pilot (Y = pilot, N = not)';

ALTER TABLE employee ADD CONSTRAINT employee_pk PRIMARY KEY ( emp_nbr );

CREATE TABLE endorsement (
    ht_nbr                   NUMBER(3) NOT NULL,
    emp_nbr                  NUMBER(4) NOT NULL,
    end_hrs_flown            NUMBER(6, 2) NOT NULL,
    end_last_annual_review   DATE NOT NULL
);

COMMENT ON COLUMN endorsement.ht_nbr IS
    'Type of helicopter identifier';

COMMENT ON COLUMN endorsement.emp_nbr IS
    'Employee number (identifier)';

COMMENT ON COLUMN endorsement.end_hrs_flown IS
    'Hours flown on this type of aircraft';

COMMENT ON COLUMN endorsement.end_last_annual_review IS
    'Last date that annual review was completed';

ALTER TABLE endorsement ADD CONSTRAINT endorsement_pk PRIMARY KEY ( ht_nbr, emp_nbr );

CREATE TABLE helicopter (
    heli_callsign    CHAR(6) NOT NULL,
    heli_hrs_flown   NUMBER(6, 2) NOT NULL,
    ht_nbr           NUMBER(3) NOT NULL
);

COMMENT ON COLUMN helicopter.heli_callsign IS
    'Helicopters call sign - identifies a helicopter';

COMMENT ON COLUMN helicopter.heli_hrs_flown IS
    'The number of hours this helicopter has flows';

COMMENT ON COLUMN helicopter.ht_nbr IS
    'Type of helicopter identifier';

ALTER TABLE helicopter ADD CONSTRAINT helicopter_pk PRIMARY KEY ( heli_callsign );

CREATE TABLE helicopter_type (
    ht_nbr             NUMBER(3) NOT NULL,
    ht_name            VARCHAR2(20) NOT NULL,
    ht_nbr_seats       NUMBER(2) NOT NULL,
    ht_cost_per_hour   NUMBER(6, 2) NOT NULL
);

COMMENT ON COLUMN helicopter_type.ht_nbr IS
    'Type of helicopter identifier';

COMMENT ON COLUMN helicopter_type.ht_name IS
    'Description for this type of helicopter';

COMMENT ON COLUMN helicopter_type.ht_nbr_seats IS
    'Number of seats available in this type of helicopter';

COMMENT ON COLUMN helicopter_type.ht_cost_per_hour IS
    'The standard charter cost for this type of helicopter';

ALTER TABLE helicopter_type ADD CONSTRAINT helicopter_type_pk PRIMARY KEY ( ht_nbr );

CREATE TABLE location (
    location_nbr    NUMBER(3) NOT NULL,
    location_name   VARCHAR2(50) NOT NULL
);

COMMENT ON COLUMN location.location_nbr IS
    'Identifier for a location';

COMMENT ON COLUMN location.location_name IS
    'The name of this location';

ALTER TABLE location ADD CONSTRAINT location_pk PRIMARY KEY ( location_nbr );

ALTER TABLE charter_leg ADD CONSTRAINT charter_cleg FOREIGN KEY ( charter_nbr )
    REFERENCES charter ( charter_nbr );

ALTER TABLE charter ADD CONSTRAINT charter_type_charter FOREIGN KEY ( ctype_nbr )
    REFERENCES charter_type ( ctype_nbr );

ALTER TABLE charter ADD CONSTRAINT client_charter FOREIGN KEY ( client_nbr )
    REFERENCES client ( client_nbr );

ALTER TABLE charter ADD CONSTRAINT employee_charter FOREIGN KEY ( emp_nbr )
    REFERENCES employee ( emp_nbr );

ALTER TABLE endorsement ADD CONSTRAINT employee_endorsement FOREIGN KEY ( emp_nbr )
    REFERENCES employee ( emp_nbr );

ALTER TABLE charter ADD CONSTRAINT helicopter_charter FOREIGN KEY ( heli_callsign )
    REFERENCES helicopter ( heli_callsign );

ALTER TABLE endorsement ADD CONSTRAINT helitype_endorsement FOREIGN KEY ( ht_nbr )
    REFERENCES helicopter_type ( ht_nbr );

ALTER TABLE helicopter ADD CONSTRAINT helitype_helicopter FOREIGN KEY ( ht_nbr )
    REFERENCES helicopter_type ( ht_nbr );

ALTER TABLE charter_leg ADD CONSTRAINT location_cleg_dest FOREIGN KEY ( location_nbr_destination
 )
    REFERENCES location ( location_nbr );

ALTER TABLE charter_leg ADD CONSTRAINT location_cleg_origin FOREIGN KEY ( location_nbr_origin
 )
    REFERENCES location ( location_nbr );

CREATE SEQUENCE charter_charter_nbr_seq START WITH 100 NOCACHE ORDER;

CREATE SEQUENCE charter_type_ctype_nbr_seq START WITH 10 NOCACHE ORDER;

CREATE SEQUENCE client_client_nbr_seq START WITH 100 NOCACHE ORDER;

CREATE SEQUENCE employee_emp_nbr_seq START WITH 100 NOCACHE ORDER;

CREATE SEQUENCE helicopter_type_ht_nbr_seq START WITH 100 NOCACHE ORDER;

CREATE SEQUENCE location_location_nbr_seq START WITH 100 NOCACHE ORDER;



-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                             9
-- CREATE INDEX                             0
-- ALTER TABLE                             20
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          6
-- CREATE MATERIALIZED VIEW                 0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
